{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Бронирование</title>
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
</head>
<body>

<div class="navbar navbar-inverse " role="navigation">
    <div class="container">
        {% if not request.user.is_authenticated %}
            <div class="navbar-header">
                <a class="navbar-brand" href="#">Гость</a>
            </div>
        {% else %}
            <div class="navbar-header">
                <a class="navbar-brand" href="#">Пользователь: {{ request.user }}</a>
            </div>
            <div class="align-content-center">
                <ul class="pull-right">
                    <a class="navbar-header" href='{% url 'logout' %}'><button type="button" class="btn btn-danger btn-sm">Выход</button></a>
                </ul>
            </div>
        {% endif %}
    </div>
</div>

<div class="container">

    {#    {% for object in booking %}#}
    {#        {% for object in item %}#}
    {#        <p>{{ object.title }}</p>#}
    {#        {% for user in object.user.all %}#}
    {#            <p>{{ user.username }}</p>#}
    {#        {% endfor %}#}
    {#        {% endfor %}#}
    {#    {% endfor %}#}

    {#       <table class="table table-bordered table-dark">#}
    {##}
    {#        <thead>#}
    {#        <tr>#}
    {#            <th scope="col">#</th>#}
    {##}
    {##}
    {#            {% for object in booking_main %}#}
    {#                <th scope="col">{{ object.title }}</th>#}
    {#            {% endfor %}#}
    {#        </tr>#}
    {#        </thead>#}
    {##}
    {#        <tbody>#}
    {#        <tr>#}
    {##}
    {#            <th scope="row">#}
    {#                <dl>#}
    {#                    <dd>C</dd>#}
    {#                    <dd>О</dd>#}
    {#                    <dd>Т</dd>#}
    {#                    <dd>Р</dd>#}
    {#                    <dd>У</dd>#}
    {#                 <dd>Д</dd>#}
    {#                    <dd>Н</dd>#}
    {#                    <dd>И</dd>#}
    {#                    <dd>К</dd>#}
    {#                    <dd>И</dd>#}
    {#                </dl>#}
    {#            </th>#}
    {##}
    {##}
    {##}
    {#            {% for object in booking_main %}#}
    {#                <td onclick="document.location='page/new.html'" scope="col">#}
    {#                    <ol type="!">#}
    {#                        {% for user in object.user.all %}#}
    {#                            <li>{{ user.username }}</li>#}
    {#                        {% endfor %}#}
    {#                    </ol>#}
    {#                </td>#}
    {##}
    {#            {% endfor %}#}
    {#        </tr>#}
    {#        <tr>#}
    {#            <th scope="row">#</th>#}
    {#            {% for object in booking_main %}#}
    {##}
    {#                <td scope="col">#}
    {##}
    {#                    <h6>Свободных мест: -</h6>#}
    {#                    <p><a class="btn btn-success" href="#" role="button">Забронировать</a></p>#}
    {#                </td>#}
    {##}
    {#            {% endfor %}#}
    {#        </tr>#}
    {##}
    {##}
    {#        </tbody>#}
    {##}
    {#    </table>#}
    {##}
    {##}
    {#    <table class="table table-bordered table-dark">#}
    {##}
    {#        <thead>#}
    {#        <tr>#}
    {#            <th scope="col">#</th>#}
    {##}
    {##}
    {#            {% for object in booking_second %}#}
    {#                <th scope="col">{{ object.title }}</th>#}
    {#            {% endfor %}#}
    {#        </tr>#}
    {#        </thead>#}
    {##}
    {#        <tbody>#}
    {#        <tr>#}
    {##}
    {#            <th scope="row">#}
    {#                <dl>#}
    {#                    <dd>C</dd>#}
    {#                    <dd>О</dd>#}
    {#                    <dd>Т</dd>#}
    {#                    <dd>Р</dd>#}
    {#                    <dd>У</dd>#}
    {#                    <dd>Д</dd>#}
    {#                    <dd>Н</dd>#}
    {#                    <dd>И</dd>#}
    {#                    <dd>К</dd>#}
    {#                    <dd>И</dd>#}
    {#                </dl>#}
    {#            </th>#}
    {##}
    {##}
    {##}
    {#            {% for object in booking_second %}#}
    {#                <td onclick="document.location='page/new.html'" scope="col">#}
    {#                    <ol type="!">#}
    {#                        {% for user in object.user.all %}#}
    {#                            <li>{{ user.username }}</li>#}
    {#                        {% endfor %}#}
    {#                    </ol>#}
    {#                </td>#}
    {##}
    {#            {% endfor %}#}
    {#        </tr>#}
    {#        <tr>#}
    {#            <th scope="row">#</th>#}
    {#            {% for object in booking_second %}#}
    {##}
    {#                <td scope="col">#}
    {##}
    {#                    <h6>Свободных мест: -</h6>#}
    {#                    <p><a class="btn btn-success" href="#" role="button">Забронировать</a></p>#}
    {#                </td>#}
    {##}
    {#            {% endfor %}#}
    {#        </tr>#}
    {##}
    {##}
    {#        </tbody>#}
    {##}
    {#    </table>#}

    {% for week in weeks %}
        <table class="table table-bordered table-dark" width="100%">
            <thead>
            <tr>
                <th width="2%" scope="col"></th>

                {% for object in week %}

                    <th width="14%" scope="col"><button type="button" class="btn btn-outline-light" data-toggle="modal" data-target="#detailModal-{{ object.id }}">{{ object.title }}</button></th>

                {% endfor %}
            </tr>
            </thead>
            <tbody>
            <tr>
                <th width="2%" scope="row">
                    <dl>
                        <dd>C</dd>
                        <dd>О</dd>
                        <dd>Т</dd>
                        <dd>Р</dd>
                        <dd>У</dd>
                        <dd>Д</dd>
                        <dd>Н</dd>
                        <dd>И</dd>
                        <dd>К</dd>
                        <dd>И</dd>
                    </dl>
                </th>
                {% for object in week %}

                    {#                    <td width="14%" onclick="document.location='page/new.html'" scope="col">#}
                    <td width="14%" onclick="send('#detailModal1')" scope="col">
                        <ol type="!">
                            {% for staff in object.user.all %}
                                <li>{{ staff.username }}</li>
                                {#                                {% if user.is_authenticated %}#}
                                {#                                   !!!!!!!!!!!#}
                                {#                                {% endif %}#}
                            {% endfor %}
                        </ol>
                    </td>

                {% endfor %}
            </tr>
            <tr>
                <th width="2%" scope="row"></th>
                {% for object in week %}

                    {#                    <td width="14%" scope="col"> #}

                    <td width="14%" scope="col">
                        {% if object.user.all.count < 14 and not user in object.user.all %}
                            <p><a class="btn btn-success btn-block" href="{% url 'reserve' str_date=object.day %}" role="button">Записаться</a></p>
                        {% elif user in object.user.all %}
                            <p><a class="btn btn-danger btn-block" href="{% url 'unreserve' str_date=object.day %}" role="button">Отменить</a></p>
                        {% elif object.user.all.count == 14 %}
                            <p><a class="btn btn-warning btn-block disabled" href="#" role="button">Зарезервировано</a></p>
                        {% endif %}
                    </td>

                {% endfor %}
            </tr>
            </tbody>

        </table>
    {% endfor %}

    <hr>
    {#    <footer>#}
    {#        <p>booking workplace</p>#}
    {#    </footer>#}

</div> <!-- /container -->
{% for week in weeks %}
    {% for object in week %}
        <div class="modal fade" id="detailModal-{{ object.id }}" tabindex="-1" role="dialog" aria-labelledby="detailModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title" id="detailModalLabel">Бронирование на: {{ object.day }}</h3>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <table class="table table-striped small">
                            <thead>
                            <tr>
                                {#                                <th scope="col"></th>#}
                                {#                                <th scope="col">Сотрудник</th>#}
                            </tr>
                            </thead>
                            <tbody>
                            {% for user in object.user.all %}
                                <tr>
                                    <th scope="row"></th>
                                    {% if user == request.user %}
                                        <td><h6 style="color:#0000ff">{{ user.username }}</h6></td>
                                    {% else %}
                                        <td><h6>{{ user.username }}</h6></td>
                                    {% endif %}
                                </tr>
                            {% endfor %}
                            </tbody>
                            <tfoot>
                            {#                            <tr>#}
                            {#                                <th></th>#}
                            {#                                <th>Всего: {{ object.user.all.count }}</th>#}
                            {#                                <th></th>#}
                            {#                                <th class="text" id="cart-total-price"><h4>{{ object.user.all.count }}</h4></th>#}
                            {#                                <th></th>#}
                            {#                            </tr>#}
                            </tfoot>
                        </table>

                        <p><h6>Свободных мест: {{ object.free_places }}</h6></p>
                        <p><h6>Дежурные: </h6></p>
                        <ul style='list-style-type:square;'>
                            <li>Администратор: -</li>
                            <li>Аналитик: -</li>
                            <li>Робот: -</li>
                            <li>Программист: -</li>
                            <li>Менеджер: -</li>
                        </ul>
                    </div>
                    <div class="modal-footer">
                        <div class = "row">
                        {% if object.user.all.count < 14 and not user in object.user.all %}
                            <p><a class="btn btn-success btn-block" href="{% url 'reserve' str_date=object.day %}" role="button">Записаться</a></p>
                        {% elif user in object.user.all %}
                            <p><a class="btn btn-danger btn-block" href="{% url 'unreserve' str_date=object.day %}" role="button">Отменить</a></p>
                        {% elif object.user.all.count == 14 %}
                            <p><a class="btn btn-warning btn-block disabled" href="#" role="button">Зарезервировано</a></p>
                        {% endif %}
                        <ul class="pull-right">
                        <p><a class="btn btn-secondary" data-dismiss="modal" role="button">Закрыть</a></p>
                        </ul>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
{% endfor %}

<script src="http://code.jquery.com/jquery-latest.js" ></script>
{#<script src="http://code.jquery.com/jquery-3.4.1.min.js"></script>#}

<script src="{% static 'js/bootstrap.min.js'%}"></script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>
</html>
